<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wirepas Single-MCU SDK: app_specific_area_id</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Wirepas Single-MCU SDK"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../small_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wirepas Single-MCU SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('de/da0/app_specific_area_id.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">app_specific_area_id </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Wirepas network supports <em>Over The Air</em> (OTAP) updates of devices on the network.</p>
<p>A network can contain heterogenous devices (different types of sensors, for example), so various different kinds of applications can coexist simultaneously in a network.</p>
<p>Even when upgrading a subset of nodes in the network (just nodes with a specific type of sensor, for example), all nodes will receive the update image. This is to ensure that all nodes on the network receive the update image, due to the multi-hop nature of the network. Consequently, it is crucial for a node to know if the received image, called a <em>scratchpad</em>, contains any updates for the node in question. This is the purpose of the application area ID.</p>
<p>More information about <em>Over The Air Protocol</em> can be found in <a class="el" href="../../d1/d7a/dedicated_area.html#relmat1">[1]</a>.</p>
<p>Each new application <b>must</b> define its own <code>app_specific_area_id</code> in its <code>config.mk</code> file. It is a random 24-bit field that must have its most significant bit set to 1 (MSB to 0 is reserved for Wirepas):</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Define a specific application area_id</span></div><div class="line"><span class="preprocessor">app_specific_area_id=0x83744C</span></div></div><!-- fragment --><p>This specific area ID will be used in two different places:</p>
<ul>
<li>The <em>bootloader</em>, which contains a list of area IDs that it accepts, when a new scratchpad is processed. All the nodes that will be flashed with the image generated from an application build (containing the bootloader) will <em>only</em> accept updates of the application matching the specific area ID defined in <code>config.mk</code>.</li>
<li>In the <em>scratchpad generation tool</em> (genscratchpad.py), where it identifies the application scratchpad image. All the <code>*.otap</code> images generated from this application build will be only accepted by nodes flashed with a bootloader matching this area ID.</li>
</ul>
<p>The <code>app_specific_area_id</code> is only part of the scratchpad area id existing on the device. The whole scratchpad area id is composed on 4 bytes, as following:</p>
<table class="doxtable">
<tr>
<th>byte #</th><th>content </th></tr>
<tr>
<td>MSB byte 0</td><td>app_specific_area_id MSB byte 0 </td></tr>
<tr>
<td>byte 1</td><td>app_specific area id byte 1 </td></tr>
<tr>
<td>byte 2</td><td>app_specific area id LSB byte 2 </td></tr>
<tr>
<td>byte 3 LSB </td><td>hardware magic (see <a class="el" href="../../dc/db2/system_8h.html#a055fd8a1c1565c12af35cd82010b2594">app_lib_system_hardware_magic_e</a>) </td></tr>
</table>
<p>For example, if <code>app_specific_area_id</code> has value of <code>0x83744C </code> and used hardware is Nordic nRF52 (i.e. <a class="el" href="../../dc/db2/system_8h.html#a055fd8a1c1565c12af35cd82010b2594">app_lib_system_hardware_magic_e</a> is <a class="el" href="../../dc/db2/system_8h.html#a055fd8a1c1565c12af35cd82010b2594a39125b2444d95b8c2d25f414acc01a54">APP_LIB_SYSTEM_HARDWARE_MAGIC_NRF52832_SP_2</a>), the resulted area id stored in the devices is: </p><div class="fragment"><div class="line">(0x83744C &lt;&lt; 8) | 3 = 0x83744C03</div></div><!-- fragment --><p>To summarize, in order to have unique scratchpad image on the device, the image must have*</p><ul>
<li>Unique <code>app_specific_area_id</code> OR</li>
<li>Unique processor architecture.</li>
</ul>
<p>If, however, same application is built on different board (but having same processor architecture), it will result same area id and otap mechanism cannot disinguish the images from others.</p>
<dl class="section note"><dt>Note</dt><dd>It is up to each customer to maintain its own set of <code>app_area_id</code> to avoid mismatch between its applications. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d3/d03/sdk_file_structure.html">SDK file structure</a></li><li class="navelem"><a class="el" href="../../d9/d82/source_folder.html">source/ Application examples</a></li><li class="navelem"><a class="el" href="../../d3/d8c/source_config_mk.html">config.mk</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
