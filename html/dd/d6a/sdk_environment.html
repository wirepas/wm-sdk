<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wirepas Single-MCU SDK: SDK Environment</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Wirepas Single-MCU SDK"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../small_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Wirepas Single-MCU SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d6a/sdk_environment.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">SDK Environment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As a prerequisite for this guide, you must be able to successfully build one of the provided application example from the SDK.</p>
<h1><a class="anchor" id="installation_of_sdk_environment"></a>
Installation of SDK Environment</h1>
<h2><a class="anchor" id="windows_installation"></a>
Windows installation using WSL</h2>
<p>For Windows installation, we're using <a href="https://docs.microsoft.com/en-us/windows/wsl/about">Windows Subsystem for Linux</a>. There are other possible options, such as <a href="https://www.cygwin.com/">Cygwin</a> or <a href="http://www.mingw.org/">MinGW</a> but they are not covered here.</p>
<p>First, install Windows Subsystem for Linux according to <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">installation guidelines</a>. Choose Ubuntu installation.</p>
<p>After done that and system is update, proceed following in bash:</p>
<p>Update the system: </p><div class="fragment"><div class="line">sudo apt update &amp;&amp; sudo apt upgrade &amp;&amp; sudo apt dist-upgrade &amp;&amp; sudo apt autoremove</div></div><!-- fragment --><h3><a class="anchor" id="wsl_compiler"></a>
Compiler installation</h3>
<p>Using <a href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads">GCC Arm toolchain version 7.2.1 (7-2017-q4-major)</a> is recommended to be used. Download the toolchain (in some directory of your own choice): </p><div class="fragment"><div class="line">wget -O gcc-arm-none-eabi-7-2017-q4-major-linux.tar.bz2 https:<span class="comment">//developer.arm.com/-/media/Files/downloads/gnu-rm/7-2017q4/gcc-arm-none-eabi-7-2017-q4-major-linux.tar.bz2?revision=375265d4-e9b5-41c8-bf23-56cbe927e156?product=GNU%20Arm%20Embedded%20Toolchain,64-bit,,Linux,7-2017-q4-major</span></div></div><!-- fragment --><p>And unpack the downloaded package: </p><div class="fragment"><div class="line">tar xjf gcc-arm-none-eabi-7-2017-q4-major-linux.tar.bz2</div></div><!-- fragment --><p>Now, there is a subfolder called <code>gcc-arm-none-eabi-7-2017-q4-major</code> containing necessary tools. You may move the folder to desired location. Modify <code>PATH</code> to contain <code>bin</code> subfolder, for example <a href="https://smallbusiness.chron.com/modify-path-ubuntu-52030.html">here </a>.</p>
<p>After that, you can verify that compiler toolchain has installed by typing: </p><div class="fragment"><div class="line">arm-none-eabi-gcc --version</div></div><!-- fragment --><p>which should produce following output: </p><div class="fragment"><div class="line">arm-none-eabi-gcc (GNU Tools <span class="keywordflow">for</span> Arm Embedded Processors 7-2017-q4-major) 7.2.1 20170904 (release) [ARM/embedded-7-branch revision 255204]</div><div class="line">Copyright (C) 2017 Free Software Foundation, Inc.</div><div class="line">This is free software; see the source <span class="keywordflow">for</span> copying conditions.  There is NO</div><div class="line">warranty; not even <span class="keywordflow">for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</div></div><!-- fragment --><h3><a class="anchor" id="wsl_misc"></a>
Miscellaneous installation</h3>
<p>Here are other software components that should be installed:</p>
<div class="fragment"><div class="line">sudo apt install build-essential python python-pip</div></div><!-- fragment --><p>Install required Python libraries: </p><div class="fragment"><div class="line">sudo pip install pycryptodome</div></div><!-- fragment --><h2><a class="anchor" id="linux_installation"></a>
Installation on Ubuntu Linux</h2>
<p>For Ubuntu-based variants, follow guideline used in <a class="el" href="../../dd/d6a/sdk_environment.html#windows_installation">Windows installation using WSL</a>.</p>
<h1><a class="anchor" id="checking_the_installation_validity"></a>
Checking the installation validity</h1>
<p><a class="el" href="../../db/d83/custom_app_2app_8c-example.html">The custom_app application</a> is a simple application that sends a periodically incrementing counter value over the Wirepas network.</p>
<p>The application can be built with the following command:</p>
<div class="fragment"><div class="line">make app_name=custom_app target_board=&lt;target_board&gt;</div></div><!-- fragment --><p>After execution of this command, you should find the <code>final_image_custom_app.hex</code> under <code>build/&lt;target_board&gt;/&lt;app_name&gt;</code> folder.</p>
<h1><a class="anchor" id="flashing_guideline"></a>
Flashing devices</h1>
<p>When using the board for the first time, the image named <code>final_image_&lt;<em>app_name</em>&gt;.hex</code> generated by the build process must be flashed. This image contains the Wirepas bootloader and a scratchpad composed by the Wirepas Mesh stack and the application. This step must be done on each new board.</p>
<p>On next boot, the stack and the application will be flashed from the scratchpad to their dedicated flash areas.</p>
<p>Using the flash mechanism is a convenient way to develop the application as long as the devices are accessible and not in high volumes. When updating a large network, using OTAP is more practical.</p>
<h2><a class="anchor" id="flashing_nordic_nrf52_devices"></a>
Flashing Nordic nRF52 devices</h2>
<p>For information on how to flash Nordic nRF52xxx devices, check out <a href="https://infocenter.nordicsemi.com/index.jsp?topic=%2Fug_nrf5x_cltools%2FUG%2Fcltools%2Fnrf5x_command_line_tools_lpage.html">nRF5x Command Line Tools User Guide</a></p>
<h2><a class="anchor" id="flashing_silabs_devices"></a>
Flashing Silicon Labs Devices</h2>
<p>First, install <a href="https://www.segger.com/downloads/jlink/#J-LinkSoftwareAndDocumentationPack">Segger J-Link Software and Documentation Pack</a></p>
<p>For information how to use Segger Jlink command-line executable (named either <code>JLink.exe </code> or <code>Jlinkexe</code> according to your operating system), refer to <a href="https://wiki.segger.com/J-Link_Commander">J-Link Commander</a>.</p>
<p>The following information should be used.</p>
<table class="doxtable">
<tr>
<th>Device architecture</th><th>Radio profile</th><th>JLink device type </th></tr>
<tr>
<td><a class="el" href="../../dd/d6a/sdk_environment.html#efr32xg12">EFR32xG12</a></td><td>2.4 GHz/SubGhz</td><td>EFR32FG12PxxxF1024 </td></tr>
</table>
<p>Note: usually interface is SWD but it depends on the hardware design. For example: <a href="https://www.silabs.com/support/getting-started/proprietary-wireless/flex-gecko">Flex Gecko</a> uses SWD.</p>
<p>Here, couple of example <em> J-Link Commander Command files</em> that can be used as a reference:</p>
<p>Programming EFR32xG12 device: </p><div class="fragment"><div class="line">device EFR32FG12PxxxF1024</div><div class="line"><span class="keywordflow">if</span> SWD</div><div class="line">speed 1000</div><div class="line">connect</div><div class="line">r</div><div class="line">loadfile &lt;path_to_hex_file&gt;.hex</div><div class="line">r</div><div class="line">g</div><div class="line">q</div></div><!-- fragment --><p>You may also need to <em>recover</em> the device when you need to:</p><ul>
<li>Remove all the parameterization</li>
<li>Flash firmware again (with protected bootloader)</li>
</ul>
<p>The recovery removes flash write protection mechanism and whole flash contents. Following command for recovering is issued when using JLink commander: </p><div class="fragment"><div class="line">J-Link&gt;unlock &lt;enter&gt;</div><div class="line">Syntax: unlock &lt;DeviceName&gt;</div><div class="line">---Supported devices---</div><div class="line">  LM3Sxxx [&lt;Auto&gt;]</div><div class="line">  Kinetis</div><div class="line">  EFM32Gxxx</div><div class="line">  LPC5460x</div><div class="line">J-Link&gt;unlock LM3Sxxx &lt;enter&gt;</div><div class="line">Be sure that nRESET is LOW before continuing.</div><div class="line">If you are working with an eval board,</div><div class="line">please press the RESET button and keep it pressed.</div><div class="line">Press enter to start unlock sequence...</div><div class="line">Unlocking device...O.K.</div><div class="line">Please power-cycle target hardware.</div></div><!-- fragment --><h1><a class="anchor" id="nordic_nrf52832_nrf52840"></a>
Resources on Nordic nRF52832 &amp; nRF52840</h1>
<p>The nRF52 chip version supported by Wirepas Mesh has minimum 512kB of flash and 64kB of RAM.</p>
<h2><a class="anchor" id="flash_memory_nrf52"></a>
Flash Memory available for application on nRF52</h2>
<p>As stated in <a class="el" href="../../d7/d28/application_operation.html#memory_partitioning">description of memory partitioning</a>, the available flash memory for application is limited by size of the memory area that is used commonly for application and also scratchpad image. If application size is too large, there is possibility that large scratchpad image will override application image. The default maximum size of the application has been set so that it is always safe to use scratchpad image that will contain both firmware and application.</p>
<p>The <em>recommended</em> maximum size of <a class="el" href="../../d3/d03/sdk_file_structure.html#flash_memory">flash memory</a> for an application is 40kB.</p>
<h2><a class="anchor" id="ram_memory_nrf52"></a>
RAM Memory available for application on nRF52</h2>
<p>Allocated <a class="el" href="../../d3/d03/sdk_file_structure.html#ram_memory">RAM memory</a> for application by the processor is following: </p><table class="doxtable">
<tr>
<th>Processor</th><th>RAM memory </th></tr>
<tr>
<td>nRF52832</td><td>Up to 16 kB (8 kB by default) </td></tr>
<tr>
<td>nRF52840</td><td>188 kB </td></tr>
</table>
<h2><a class="anchor" id="peripherals_accessible_by_stack_only"></a>
Peripherals accessible by stack only</h2>
<p>Some peripherals are used by the Wirepas Mesh stack and cannot be used by the application.</p>
<table class="doxtable">
<tr>
<th>Peripheral</th><th>Associated interrupt (from file mcu/nrf52/vendor/nrf52.h) </th></tr>
<tr>
<td>Power</td><td><code>POWER_CLOCK_IRQn</code> </td></tr>
<tr>
<td>Radio</td><td><code>RADIO_IRQn</code> </td></tr>
<tr>
<td>Timer0</td><td><code>TIMER0_IRQn</code> </td></tr>
<tr>
<td>WDT</td><td><code>WDT_IRQn</code> </td></tr>
<tr>
<td>Rtc1</td><td><code>RTC1_IRQn</code> </td></tr>
<tr>
<td>ECB (AES)</td><td><code>ECB_IRQn</code> </td></tr>
<tr>
<td>PPI (Channels 0, 1 and 2)</td><td><code>None</code> </td></tr>
</table>
<p>All the internal interrupt of cortex M are handled by the stack directly (NMI, HardFault,...)</p>
<h2><a class="anchor" id="peripherals_shared_between_the_stack_and_the_application"></a>
Peripherals Shared between the stack and the application</h2>
<p>Some peripherals are used by the stack but can also be accessed by the application. There is a <a class="el" href="../../d7/de1/hardware_8h.html#d0/d0c/structapp__lib__hardware__t">dedicated API</a> to reserve these peripherals.</p>
<p>These peripherals must be reserved through the API before being used and the application must initialize them each time after reserving it. In fact, the stack may configure them differently.</p>
<p>It is also important to avoid long reservation of theses peripherals to let the stack use them for its own purpose.</p>
<table class="doxtable">
<tr>
<th>Peripheral</th><th>Reservation ID (from <a class="el" href="../../d7/de1/hardware_8h.html#ad0a85f67c1b871307b2059391432fa37">app_lib_hardware_peripheral_e</a>) </th></tr>
<tr>
<td>ADC</td><td><a class="el" href="../../d7/de1/hardware_8h.html#ad0a85f67c1b871307b2059391432fa37a14269f591fca037cfe5eba479fe2efd6">APP_LIB_HARDWARE_PERIPHERAL_ADC</a> </td></tr>
<tr>
<td>Temp</td><td><a class="el" href="../../d7/de1/hardware_8h.html#ad0a85f67c1b871307b2059391432fa37a6083353c8f1646dbaddeed2562b08de9">APP_LIB_HARDWARE_PERIPHERAL_TEMPERATURE</a> </td></tr>
</table>
<h2><a class="anchor" id="peripherals_available_for_the_application"></a>
Peripherals available for the application</h2>
<p>All the other peripherals not listed above are free to be used by the application.</p>
<h1><a class="anchor" id="efr32xg12"></a>
Resources on EFR32xG12</h1>
<p>Following chip variants (at 2.4 GHz only) are supported:</p>
<ul>
<li>EFR32FG12P232F1024G L125/M48 [2.4 GHz only, 1024/128, BGA125/QFN48]</li>
<li>EFR32FG12P432F1024G L125/M48 [2.4 GHz only, 1024/256, BGA125/QFN48]</li>
<li>EFR32FG12P433F1024G L125/M48 [2.4 GHz &amp; SubGHz, 1024/256, BGA125/QFN48]</li>
<li>EFR32MG12P232F1024G L125/M48 [2.4 GHz only, 1024/128, BGA125/QFN48]</li>
<li>EFR32MG12P332F1024G L125/M48 [2.4 GHz only, 1024/128, BGA125/QFN48]</li>
<li>EFR32MG12P432F1024G L125/M48 [2.4 GHz only, 1024/256, BGA125/QFN48]</li>
<li>EFR32MG12P433F1024G L125/M48 [2.4 GHz &amp; SubGHz, 1024/256, BGA125/QFN48]</li>
<li>EFR32BG12P232F1024G L125/M48 [2.4 GHz only, 1024/128, BGA125/QFN48]</li>
<li>EFR32BG12P432F1024G L125/M48 [2.4 GHz only, 1024/256, BGA125/QFN48]</li>
<li>EFR32BG12P433F1024G L125/M48 [2.4 GHz &amp; SubGHz, 1024/256, BGA125/QFN48]</li>
</ul>
<h2><a class="anchor" id="flash_memory_efr32"></a>
Flash Memory available for application on EFR32</h2>
<p>As stated in <a class="el" href="../../d7/d28/application_operation.html#memory_partitioning">description of memory partitioning</a>, the available flash memory for application is limited by size of the memory area that is used commonly for application and also scratchpad image. If application size is too large, there is possibility that large scratchpad image will override application image. The default maximum size of the application has been set so that it is always safe to use scratchpad image that will contain both firmware and application.</p>
<p>The <em>recommended</em> maximum size of <a class="el" href="../../d3/d03/sdk_file_structure.html#flash_memory">flash memory</a> for an application, according to processor type is following:</p>
<table class="doxtable">
<tr>
<th>Processor</th><th>Flash memory </th></tr>
<tr>
<td>efr32xg12pxxxf1024</td><td>256kB </td></tr>
<tr>
<td>efr32xg12pxxxf512</td><td>40kB </td></tr>
<tr>
<td>efr32xg13pxxxf512</td><td>40kB </td></tr>
</table>
<h2><a class="anchor" id="ram_memory_efr32"></a>
RAM Memory available for application on EFR32</h2>
<p>Allocated <a class="el" href="../../d3/d03/sdk_file_structure.html#ram_memory">RAM memory</a> for application, by the processor is following: </p><table class="doxtable">
<tr>
<th>Processor</th><th>RAM memory </th></tr>
<tr>
<td>efr32xg12pxxxf1024</td><td>72kB </td></tr>
<tr>
<td>efr32xg12pxxxf512</td><td>8kB </td></tr>
<tr>
<td>efr32xg13pxxxf512</td><td>16kB </td></tr>
</table>
<h2><a class="anchor" id="peripherals_accessible_by_stack_only2"></a>
Peripherals accessible by stack only</h2>
<p>Some peripherals are used by the Wirepas Mesh stack and cannot be used by the application.</p>
<table class="doxtable">
<tr>
<th>Peripheral</th><th>Associated interrupt (from chip vendor files) </th></tr>
<tr>
<td><code>TIMER0</code></td><td><code>TIMER0_IRQn</code> </td></tr>
<tr>
<td><code>RTCC</code></td><td><code>RTCC_IRQn</code> </td></tr>
<tr>
<td><code>WDOG0</code></td><td><code>WDOG0_IRQn</code> </td></tr>
<tr>
<td><code>CMU</code></td><td><code>CMU_IRQn</code> </td></tr>
<tr>
<td><code>CRYPTO0</code></td><td><code>CRYPTO0_IRQn</code> </td></tr>
</table>
<p>All the internal interrupt of cortex M are handled by the stack directly (NMI, HardFault,...)</p>
<h2><a class="anchor" id="peripherals_shared_between_the_stack_and_the_application2"></a>
Peripherals Shared between the stack and the application</h2>
<p>Some peripherals are used by the stack but can also be accessed by the application.</p>
<p>These peripherals must be reserved through the API before being used and the application must initialize them each time after reserving it. In fact, the stack may configure them differently.</p>
<p>It is also important to avoid long reservation of theses peripherals to let the stack use them for its own purpose.</p>
<table class="doxtable">
<tr>
<th>Peripheral</th><th>Reservation ID (from <a class="el" href="../../d7/de1/hardware_8h.html#ad0a85f67c1b871307b2059391432fa37">app_lib_hardware_peripheral_e</a>) </th></tr>
<tr>
<td>ADC0</td><td><a class="el" href="../../d7/de1/hardware_8h.html#ad0a85f67c1b871307b2059391432fa37a14269f591fca037cfe5eba479fe2efd6">APP_LIB_HARDWARE_PERIPHERAL_ADC</a> </td></tr>
</table>
<h2><a class="anchor" id="peripherals_available_for_the_application2"></a>
Peripherals available for the application</h2>
<p>All the other peripherals not listed above are free to be used by the application.</p>
<h1>Related Material </h1>
<p><a class="anchor" id="relmat3"></a>[3] WP-RM-108 - OTAP Reference Manual</p>
<p><a class="anchor" id="relmat4"></a>[4] WP-RM-100 - Wirepas Mesh Dual-MCU API Reference Manual </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Mar 12 2020 12:10:29 for Wirepas Single-MCU SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
